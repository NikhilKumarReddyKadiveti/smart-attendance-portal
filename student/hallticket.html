<!DOCTYPE html>
<html>
<head>
    <title>Hall Ticket</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <script src="../assets/js/main.js"></script>
    <script>const user = checkAuth('student'); renderNav(user);</script>

    <div class="container">
        <h2>Hall Tickets (For Closed Courses)</h2>
        <div id="tickets"></div>
    </div>

    <script>
        async function loadTickets() {
            const tickets = await apiCall(`/hallticket?studentId=${user._id}`);
            const div = document.getElementById('tickets');
            
            if(tickets.length === 0) div.innerHTML = "<p>No hall tickets available yet.</p>";

            div.innerHTML = tickets.map(t => `
                <div class="glass-panel" style="border-left: 5px solid ${t.eligible ? 'green' : 'red'}">
                    <h3>${t.courseName}</h3>
                    <p>Student: ${t.studentName} (${t.rollNumber})</p>
                    <p>Attendance: ${t.percentage}%</p>
                    <h4 style="margin-top:10px; color:${t.eligible ? 'var(--accent)' : 'red'}">
                        STATUS: ${t.eligible ? 'ELIGIBLE' : 'DETAINED'}
                    </h4>
                    ${t.eligible ? '<button class="btn btn-secondary" onclick="window.print()">Print Ticket</button>' : ''}
                </div>
            `).join('');
        }
        loadTickets();
    </script>
</body>
</html>
