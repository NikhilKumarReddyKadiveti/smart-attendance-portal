<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>Hall Ticket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @media print { .no-print { display: none; } }
        .ticket-border { border: 2px dashed #333; padding: 30px; }
    </style>
</head>
<body>
    <div class="container mt-5" id="ticketContent">
        <div class="ticket-border text-center">
            <h1>Smart Attendance Portal</h1>
            <h3>Official Hall Ticket</h3>
            <hr>
            <div class="row text-start mt-4">
                <div class="col-6">
                    <p><strong>Student:</strong> <span id="sName"></span></p>
                    <p><strong>Exam:</strong> Semester End Exams 2024</p>
                </div>
                <div class="col-6 text-end">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=Verified" width="100">
                </div>
            </div>
            <div id="eligibilityMessage" class="alert mt-4"></div>
            <button onclick="window.print()" class="btn btn-dark mt-3 no-print">Print Hall Ticket</button>
        </div>
    </div>
    <script>
        const user = JSON.parse(sessionStorage.getItem('user'));
        document.getElementById('sName').innerText = user.name;
        
        async function checkEligibility() {
            // Logic to check if user has > 75% across all courses
            const res = await fetch(`/api/attendance?studentId=${user.id}`);
            const logs = await res.json();
            // Simple logic: if records exist, grant ticket (demo logic)
            const msg = document.getElementById('eligibilityMessage');
            if(logs.length > 0) {
                msg.classList.add('alert-success');
                msg.innerText = "Status: ELIGIBLE";
            } else {
                msg.classList.add('alert-danger');
                msg.innerText = "Status: NOT ELIGIBLE (Shortage of Attendance)";
            }
        }
        checkEligibility();
    </script>
</body>
</html>
