<!DOCTYPE html>
<html>
<head>
    <title>Student Dashboard</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/animations.css">
</head>
<body>
    <script src="../assets/js/main.js"></script>
    <script>const user = checkAuth('student'); renderNav(user);</script>

    <div class="container fade-in">
        <div style="display:flex; gap:10px; margin-bottom:20px">
            <button class="btn btn-secondary" onclick="window.location.href='profile.html'">My Profile</button>
            <button class="btn btn-secondary" onclick="window.location.href='hallticket.html'">Hall Tickets</button>
            <button class="btn btn-secondary" onclick="window.location.href='fees.html'">Pay Fees</button>
        </div>

        <h2>Attendance Summary</h2>
        <div id="attendanceGrid" class="grid-cols-2"></div>
    </div>

    <script>
        async function loadData() {
            const data = await apiCall(`/attendance?studentId=${user._id}`);
            const grid = document.getElementById('attendanceGrid');
            
            grid.innerHTML = data.map(item => {
                const color = item.percentage < 75 ? 'red' : 'var(--accent)';
                return `
                <div class="glass-panel pulse">
                    <h3>${item.courseName}</h3>
                    <div style="font-size: 2rem; color: ${color}; font-weight:bold;">
                        ${item.percentage}%
                    </div>
                    <p>Attended: ${item.attended} / ${item.totalClasses}</p>
                    ${item.percentage < 75 ? '<p style="color:red; font-size:0.8rem">⚠️ Low Attendance Warning</p>' : ''}
                </div>
                `;
            }).join('');
        }
        loadData();
    </script>
</body>
</html>
