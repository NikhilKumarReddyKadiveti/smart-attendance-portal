<!DOCTYPE html>
<html>
<head>
    <title>Fee Payment</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <script src="../assets/js/main.js"></script>
    <script>const user = checkAuth('student'); renderNav(user);</script>

    <div class="container">
        <h2>Fee Details</h2>
        <div id="feeContainer"></div>
    </div>

    <script>
        async function loadFees() {
            const fees = await apiCall(`/fees?studentId=${user._id}`);
            const div = document.getElementById('feeContainer');
            
            div.innerHTML = fees.map(f => `
                <div class="glass-panel">
                    <h3>${f.term}</h3>
                    <p>Amount: ₹${f.amount}</p>
                    <p>Status: <span style="color:${f.status==='Paid'?'green':'orange'}">${f.status}</span></p>
                    ${f.status !== 'Paid' 
                        ? `<button class="btn" onclick="pay('${f.term}', ${f.amount})">Pay Now (Simulated)</button>` 
                        : '<button class="btn btn-secondary" disabled>Paid ✅</button>'}
                </div>
            `).join('');
        }

        async function pay(term, amount) {
            if(!confirm("Simulate payment of ₹"+amount+"?")) return;
            try {
                await apiCall('/fees', 'POST', { studentId: user._id, term, amount });
                alert("Payment Successful!");
                loadFees();
            } catch(e) { alert(e.message); }
        }
        loadFees();
    </script>
</body>
</html>
